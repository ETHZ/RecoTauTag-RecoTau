#! /bin/env cmsRun

process myTauTagAnalyzer = {
  
service = AdaptorConfig {}

source = PoolSource{
  untracked vstring fileNames = { 	
'/store/RelVal/2007/6/22/RelVal-RelVal150QCD_pt80_120-1182500741/0000/7EEAEE46-BD20-DC11-848C-000423D9880C.root'    
  }
}
untracked PSet maxEvents = {untracked int32 input = -1}

include "TrackingTools/TransientTrack/data/TransientTrackBuilder.cfi"

# Message Logger
include "FWCore/MessageLogger/data/MessageLogger.cfi"

# Magnetic Field
include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"

# Geometry
include "Geometry/CMSCommonData/data/cmsIdealGeometryXML.cff"
include "Geometry/CommonDetUnit/data/globalTrackingGeometry.cfi"
include "Geometry/CaloEventSetup/data/CaloGeometry.cfi"
include "Geometry/CaloEventSetup/data/CaloTopology.cfi"
       
include "RecoTauTag/CombinedTauTag/data/coneIsolation.cfi"
include "RecoTauTag/CombinedTauTag/data/combinedTauTag.cfi"

### Begin of DB config #######################################################
include "CondCore/DBCommon/data/CondDBCommon.cfi"

#replace CondDBCommon.connect = "sqlite_file:tautagnew1.db"  
#replace CondDBCommon.catalog = "file:mycatalog.xml"
replace CondDBCommon.connect = "oracle://cms_orcoff_int2r/CMS_COND_BTAU"    
replace CondDBCommon.catalog = "relationalcatalog_oracle://cms_orcoff_int2r/CMS_COND_GENERAL"            
  
replace CondDBCommon.DBParameters.messageLevel = 3
replace CondDBCommon.DBParameters.authenticationPath = "/afs/cern.ch/cms/DB/conddb"
es_source = PoolDBESSource { 
  using CondDBCommon
  VPSet toGet = { { string record = "CombinedTauTagRcd" string tag = "combinedtautag_likelihoodratioPDFs_0" } }
}
module get = EventSetupRecordDataGetter { 
  VPSet toGet = { { string record = "CombinedTauTagRcd" vstring data = {"CombinedTauTagCalibration"} } }
  untracked bool verbose = true 
}
##### End of DB config #######################################################

 module caloTau = CaloRecoTauProducer{
	InputTag CombinedTauTagInfo = combinedTauTag
	double LeadTrack_minPt = 6.0
	double Tracks_minPt = 1.0
	double MatchingConeSize = 0.1
	double TrackerSignalConeSize = 0.1
	bool UseTrackerSignalConeVariableSize = false
	double TrackerSignalConeVariableSize_Parameter = 3.5
	double TrackerSignalConeVariableSize_max = 0.1
	double TrackerSignalConeVariableSize_min = 0.05
	double TrackerIsolConeSize = 0.5
	double ECALSignalConeSize = 0.5
	double ECALIsolConeSize =0.13
       
    }
    module caloTauTest = CaloTauTest{
	string Taus = "caloTau" 
    }
    module out = PoolOutputModule 
    { 
	untracked string fileName = "/build/gennai/caloTauReco.root"
    }

# module execution
path p={coneIsolation,combinedTauTag,caloTau, caloTauTest}
endpath pout={out}
}
